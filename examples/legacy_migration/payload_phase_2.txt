SYSTEM RESET. FORMAT=TOON. STRICT MODE: Code only, no explanations. `>>>` denotes raw file. EXECUTE `PROCESS_STACK`.

KERNEL:
  role: "Senior Rust Engineer"
  mode: "Strict Implementation"
  token_budget: 8000

REGISTERS:
  project: "OmniCorp Core Modernization"
  target_language: "Rust"
  current_module: "Interest Calculation"
  phase: "Implementation"

MEMORY_POINTERS[2]{type, path, description}:
  "file", "@rust_safety.md", "Rust Safety Guidelines"
  "file", "@bank_rules_1985.txt", "Business Rules (1985)"

PROCESS_STACK[1]{priority, task}:
  "1", "Implement the interest calculation logic in Rust, strictly following safety guidelines."


SESSION_SCRATCHPAD:
  session_notes: >-
    Analysis complete. COBOL source removed to prevent syntax contamination.
    Focusing on type safety and error handling.

  todo_list:
    - "Implement logic"
    - "Add property tests"

  current_focus: >-
    Implementation Phase


# RESOLVED_MEMORY

@rust_safety.md:
>>>
# RUST IMPLEMENTATION GUIDELINES - OMNICORP MODERNIZATION

## 1. Type Safety
- NEVER use floating point numbers (`f64`, `f32`) for currency.
- Use the `rust_decimal` crate or an integer-based fixed-point representation (micros).

## 2. Error Handling
- No `unwrap()` or `expect()`. Use `Result` and propagate errors.
- Legacy logic failures should return `LegacyMigrationError::LogicMismatch`.

## 3. Variable Naming
- Use `snake_case`.
- Do NOT use Hungarian notation (e.g., no `fBalance`).
- Do NOT use COBOL-style variable names (e.g., `CALCULATED-INTEREST` -> `calculated_interest`).

## 4. Testing
- Every legacy quirk must have a corresponding unit test case.
- Use property-based testing (`proptest`) to verify rounding behavior against the legacy implementation.
<<<

@bank_rules_1985.txt:
>>>
OMNICORP BANKING STANDARDS (1985 EDITION)

SECTION 4.2: INTEREST CALCULATION

1. STANDARD RATE:
   All savings accounts shall accrue interest at the base rate of 4.5% per annum.

2. HIGH VALUE BONUS:
   Accounts with a balance exceeding $50,000.00 shall receive a bonus of 0.5% (total 5.0%).

3. ROUNDING (THE "NY EXCEPTION"):
   Due to hardware limitations on the IBM 3090 in the New York branch (NY-01),
   interest calculations must be TRUNCATED (floor), not rounded, to the second decimal place.

   IMPORTANT: This bug became a feature. Customers in NY-01 are contractually bound
   to this calculation method. DO NOT FIX THIS BUG.

   For all other branches, standard half-up rounding applies.
<<<
